<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8"/>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.0/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.0/js/bootstrap.min.js"></script>
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>

<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<meta name="apple-mobile-web-app-title" content="Cloudant CORS test"/>

<title>Cloudant CORS test</title>

<style>
</style>
<script>
function create_doc(){
  var hostname = $('#hostname').val();
  var username = $('#username').val();
  var password = $('#password').val();
  var db = $('#db').val();
  if( hostname && username && password && db ){
    var id = generateId();
    $.ajax({
      url: 'https://' + hostname + '/' + db + '/' + id,
      type: 'PUT',
      data: { name: 'きむら', timestamp: ( new Date() ).getTime() },
      beforeSend: function( xhr ){
        xhr.setRequestHeader( "Authorization", "Basic " + btoa( username + ":" + password ) );
      },
      success: function( result ){
        console.log( result );
      },
      error: function( e0, e1, e2 ){
        console.log( e0, e1, e2 );
      }
    });
  }
}

function generateId(){
  var s = 1000;
  var id = '' + ( new Date().getTime().toString(16) ) + Math.floor( s * Math.random() ).toString(16);

  return id;
}
</script>

<body>

<div class="container">
  <input type="text" id="hostname" placeholder="hostname" style="width: 600px;" value="-bluemix.cloudantnosqldb.appdomain.cloud"/><br/>
  <input type="text" id="db" placeholder="db" style="width: 200px;" value="mydb"/>
  <input type="text" id="username" placeholder="username" style="width: 200px;" value=""/>
  <input type="password" id="password" placeholder="password" style="width: 200px;" value=""/>
  <button class="btn btn-primary" onClick="create_doc();">Create</button>
</div>

</body>
</html>
